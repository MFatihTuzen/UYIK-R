---
title: "R Programlama ile Veri Analizi"
subtitle: "Veri Ã–n Ä°ÅŸleme"
author: "Dr. Muhammed Fatih TÃœZEN"
date: 2025-5-16
date-format: "DD-MM-YYYY"
format: 
  revealjs:
    theme: white
    slide-number: true
    slide-number-format: "c / t"
    footer: "AltÄ±ncÄ± UluslararasÄ± UygulamalÄ± Ä°statistik Kongresi (UYIK 2025)"
    css: custom.css
    scrollable: true
    logo: images/TUiK_logo_Tr.jpg
editor: visual
execute:
  echo: true
  eval: true
  warnings: false
  messages: false
---

## Sunum PlanÄ±

<div>

::: nonincremental
-   **Veri Ã–n Ä°ÅŸleme**
-   **Eksik Veriler**
-   **Ä°mputasyon (Doldurma YÃ¶ntemleri)**
-   **AykÄ±rÄ± DeÄŸer Analizi**
-   **Veri NormalleÅŸtirme (Ã–lÃ§ekleme)**
:::

<div>

ğŸ“¦ Ders Materyalleri: <https://github.com/MFatihTuzen/UYIK-R>

</div>

</div>

------------------------------------------------------------------------

## ğŸ§¹ Veri Ã–n Ä°ÅŸleme Nedir?

### ğŸ“˜ TanÄ±m

Veri Ã¶n iÅŸleme, **ham veriyi analiz edilebilir, temiz ve anlamlÄ± hale getirme sÃ¼recidir.**\
Bu adÄ±m, istatistiksel analiz, makine Ã¶ÄŸrenmesi ve raporlama sÃ¼reÃ§lerinin temelidir.

### ğŸ” Neden Gereklidir?

-   GerÃ§ek dÃ¼nya verisi genellikle **eksik**, **hatalÄ±**, **daÄŸÄ±nÄ±k**, **Ã¶lÃ§eksizdir**
-   Model performansÄ±nÄ± ve analiz doÄŸruluÄŸunu doÄŸrudan etkiler
-   Veri kalitesi analiz kalitesini doÄŸrudan belirler
-   â€œÃ‡Ã¶p girerse Ã§Ã¶p Ã§Ä±karâ€ â†’ Garbage In, Garbage Out ğŸ—‘ï¸

### ğŸ“Š Modelleme SÃ¼recindeki Yeri

> `Veri Toplama â†’ Veri Ã–n Ä°ÅŸleme â†’ Modelleme â†’ DeÄŸerlendirme â†’ Raporlama`

ğŸ¯ GÃ¼Ã§lÃ¼ modellerin temelinde iyi hazÄ±rlanmÄ±ÅŸ veri yatar

------------------------------------------------------------------------

## ğŸ§­ Veri Ã–n Ä°ÅŸleme Hangi AdÄ±mlarÄ± Kapsar?

### ğŸ”„ Genel SÃ¼reÃ§ AdÄ±mlarÄ±

1.  **Veri Temizleme**
    -   Eksik gÃ¶zlemler (NA)
    -   AykÄ±rÄ± deÄŸerler
    -   Bozuk formatlar, tutarsÄ±z kategoriler
2.  **Veri DÃ¶nÃ¼ÅŸtÃ¼rme**
    -   Ã–lÃ§ekleme (normalleÅŸtirme / standardizasyon)
    -   Kodlama (kategori â†’ sayÄ±sal)
    -   DÃ¶nÃ¼ÅŸÃ¼mler (log, sqrt vs.)
3.  **Veri BÃ¼tÃ¼nleÅŸtirme**
    -   FarklÄ± kaynaklardan verilerin birleÅŸtirilmesi
    -   Join, merge, bind iÅŸlemleri
4.  **DeÄŸiÅŸken SeÃ§imi / Ã–zellik MÃ¼hendisliÄŸi**
    -   Gereksiz deÄŸiÅŸkenlerin Ã§Ä±karÄ±lmasÄ±
    -   Yeni deÄŸiÅŸkenlerin oluÅŸturulmasÄ±

## ğŸ› ï¸ SÄ±k KullanÄ±lan Fonksiyonlar & Paketler

### ğŸ” R FonksiyonlarÄ±

-   `is.na()`, `summary()`, `glimpse()`, `str()`
-   `mutate()`, `if_else()`, `case_when()`
-   `scale()`, `cut()`, `factor()`
-   `rename()`, `select()`, `arrange()`

### ğŸ“¦ FaydalÄ± Paketler

-   `dplyr`, `tidyr` â†’ veri dÃ¶nÃ¼ÅŸtÃ¼rme
-   `janitor` â†’ deÄŸiÅŸken isimlerini temizleme (`clean_names()`)
-   `naniar`, `VIM` â†’ eksik veri gÃ¶rselleÅŸtirme
-   `recipes`, `caret` â†’ Ã¶lÃ§ekleme, Ã¶n iÅŸleme zinciri
-   `datawizard`, `forcats`, `lubridate` â†’ Ã¶zel veri tÃ¼rleriyle Ã§alÄ±ÅŸma

> ğŸ” Ã–n iÅŸleme sadece temizlik deÄŸil; aynÄ± zamanda **hazÄ±rlÄ±k ve gÃ¼Ã§lendirme** sÃ¼recidir.
>
> ğŸ’¡ Analizin kalitesi veriye ne kadar iyi dokunduÄŸunuzla doÄŸrudan iliÅŸkilidir.

------------------------------------------------------------------------

## ğŸ“‚ KullanÄ±lacak Veri Seti: `airquality`

### ğŸ“˜ TanÄ±m

`airquality` veri seti, **New York'ta MayÄ±sâ€“EylÃ¼l 1973** tarihleri arasÄ±nda gÃ¼nlÃ¼k olarak Ã¶lÃ§Ã¼len hava kalitesi verilerini iÃ§erir.\
R iÃ§inde **hazÄ±r olarak** gelir, kuruluma gerek yoktur.

### ğŸ”¢ DeÄŸiÅŸkenler

| DeÄŸiÅŸken  | AÃ§Ä±klama                             |
|-----------|--------------------------------------|
| `Ozone`   | Ozon miktarÄ± (ppb)                   |
| `Solar.R` | GÃ¼neÅŸ radyasyonu (lang)              |
| `Wind`    | RÃ¼zgar hÄ±zÄ± (mph)                    |
| `Temp`    | SÄ±caklÄ±k (Fahrenheit)                |
| `Month`   | Ay bilgisi (5 = MayÄ±s, â€¦, 9 = EylÃ¼l) |
| `Day`     | GÃ¼n bilgisi                          |

### â— Veri Ã–zellikleri

-   **Eksik deÄŸerler** var (`Ozone`, `Solar.R`)
-   **AykÄ±rÄ± gÃ¶zlemler** tespit edilebilir
-   TÃ¼m sayÄ±sal deÄŸiÅŸkenler â†’ **Ã¶lÃ§ekleme iÃ§in uygun**
-   KÃ¼Ã§Ã¼k boyutlu ve eÄŸitime ideal

> ğŸ§ª TÃ¼m uygulamalarÄ± bu veri seti Ã¼zerinden gerÃ§ekleÅŸtireceÄŸiz

------------------------------------------------------------------------

## ğŸ§© Eksik Veri Nedir?

### ğŸ“˜ TanÄ±m

Eksik veri (missing data), bir gÃ¶zlem birimi iÃ§in **ilgili deÄŸiÅŸkenin deÄŸerinin mevcut olmamasÄ±** durumudur.\
R ortamÄ±nda bu durum `NA` (Not Available) ile gÃ¶sterilir.

### ğŸ“‰ Neden Ã–nemlidir?

-   SonuÃ§larÄ±n **yanlÄ±** olmasÄ±na neden olabilir
-   Ã–rneklem bÃ¼yÃ¼klÃ¼ÄŸÃ¼nÃ¼ azaltÄ±r
-   BazÄ± analizler `NA` barÄ±ndÄ±ran gÃ¶zlemleri dÄ±ÅŸlar
-   BazÄ± yÃ¶ntemler eksik veri iÃ§eren deÄŸiÅŸkenlerde **Ã§alÄ±ÅŸmaz**

> â— Eksik veriyi silmek deÄŸil, **anlamak ve doÄŸru yÃ¶netmek** gerekir.

------------------------------------------------------------------------

## â“ Eksik Veri Neden OluÅŸur? â€“ TÃ¼rleri

### ğŸ’¥ YaygÄ±n Nedenler

-   Ã–lÃ§Ã¼m yapÄ±lmamasÄ±
-   Cevap vermeme (anketler)
-   SensÃ¶r hatalarÄ±
-   Veri aktarÄ±m sorunlarÄ±
-   Filtreleme/kriterlere baÄŸlÄ± dÄ±ÅŸlama

### ğŸ§  Eksik Veri TÃ¼rleri

| TÃ¼r      | AÃ§Ä±klama                                                                                              |
|-------------|-----------------------------------------------------------|
| **MCAR** | Eksiklik rastgele ve tÃ¼m gÃ¶zlemler iÃ§in eÅŸit olasÄ±lÄ±kla oluÅŸur                                        |
| **MAR**  | Eksiklik, gÃ¶zlemlenebilen diÄŸer deÄŸiÅŸkenlerle iliÅŸkilidir (Ã¶rneÄŸin yaÅŸ arttÄ±kÃ§a eksik olma olasÄ±lÄ±ÄŸÄ±) |
| **MNAR** | Eksiklik, gÃ¶zlemlenemeyen bir Ã¶zelliÄŸe baÄŸlÄ±dÄ±r (Ã¶rneÄŸin Ã§ok hasta bireylerin veri vermemesi)         |

> ğŸ¯ TÃ¼rÃ¼nÃ¼ bilmek â†’ uygun iÅŸlem tekniÄŸini seÃ§mek iÃ§in kritik!

------------------------------------------------------------------------

## ğŸ§  Eksik Veri TÃ¼rleri â€“ AÃ§Ä±klamalar ve Ã–rnekler

### ğŸ“Œ 1. MCAR â€“ Missing Completely at Random

> Eksik deÄŸerler tamamen rastgele oluÅŸur; **hiÃ§bir deÄŸiÅŸkenle iliÅŸkili deÄŸildir.**

ğŸ” **Ã–rnek:**\
Anket kÃ¢ÄŸÄ±dÄ±nÄ±n bir kÄ±smÄ±nÄ±n yanlÄ±ÅŸlÄ±kla yÄ±rtÄ±lmasÄ± ve bazÄ± sorularÄ±n kaybolmasÄ±

âœ… Yorum:\
Analiz iÃ§in en gÃ¼venli eksiklik tÃ¼rÃ¼dÃ¼r â†’ **yanlÄ±lÄ±k yaratmaz**

### ğŸ“Œ 2. MAR â€“ Missing at Random

> Eksiklik, gÃ¶zlemlenebilen baÅŸka bir deÄŸiÅŸkenle iliÅŸkilidir.\
> Eksiklik rastgele deÄŸildir, **ama aÃ§Ä±klanabilir.**

ğŸ” **Ã–rnek:**\
YaÅŸ arttÄ±kÃ§a gelir bilgisini paylaÅŸmama olasÄ±lÄ±ÄŸÄ± artar (yaÅŸ gÃ¶zlemlenebilir ama gelir eksik)

âš ï¸ Yorum:\
Eksik veri atamalarÄ± yapÄ±labilir, ama dikkatli olmak gerekir

### ğŸ“Œ 3. MNAR â€“ Missing Not at Random

> Eksiklik, **gÃ¶zlemlenemeyen bir nedene** baÄŸlÄ±dÄ±r.\
> Eksik olma durumu, doÄŸrudan eksik deÄŸerin kendisiyle ilgilidir.

ğŸ” **Ã–rnek:**\
AÅŸÄ±rÄ± yÃ¼ksek gelirli bireylerin gelir bilgisini gizlemesi (kimlerin eksik bÄ±raktÄ±ÄŸÄ± bilgisi gÃ¶zlemlenemiyor)

ğŸš¨ Yorum:\
Modelleme iÃ§in **en riskli durumdur** â†’ Ä°mputasyon yanlÄ± olabilir

> ğŸ¯ Eksik verinin tÃ¼rÃ¼ bilinmeden doÄŸru mÃ¼dahale yapÄ±lamaz!

------------------------------------------------------------------------

## ğŸ” R ile Eksik Veri Tespiti

### ğŸ”§ Temel Fonksiyonlar

```{r}
summary(airquality)
```

Her deÄŸiÅŸkenin minâ€“max, NA durumu gÃ¶rÃ¼lÃ¼r.

```{r}
sum(is.na(airquality))
colSums(is.na(airquality))
```

TÃ¼m veri setindeki ve deÄŸiÅŸken bazlÄ± eksik deÄŸer sayÄ±larÄ±

### ğŸ“Œ Eksik olan gÃ¶zlemleri filtreleme

```{r}
airquality[!complete.cases(airquality), ]
```

-   En az bir NA iÃ§eren satÄ±rlar

-   `complete.cases()` fonksiyonu Ã§ok gÃ¼Ã§lÃ¼ ve pratik

ğŸ¯ SayÄ±sal tespit analizden Ã¶nce kontrol listesinin baÅŸÄ±nda olmalÄ±

------------------------------------------------------------------------

## ğŸ§° Eksik Veriyi GÃ¶rselleÅŸtirme

### ğŸ“¦ `naniar` paketi

```{r}
library(naniar)
gg_miss_var(airquality)
```

DeÄŸiÅŸken bazÄ±nda eksik oranÄ± Ã§ubuÄŸu

```{r}
vis_miss(airquality)
```

Tabloda eksik vs dolu alanlarÄ±n gÃ¶sterimi (Ä±sÄ± haritasÄ± gibi)

## ğŸ“¦ Alternatif: `visdat` paketi

```{r}
library(visdat)
vis_dat(airquality)
```

Veri tipleriyle birlikte eksikliÄŸi ve yapÄ±yÄ± renkli olarak sunar

------------------------------------------------------------------------

## ğŸ”„ Eksik Veri Doldurma (Ä°mputasyon) Nedir?

### ğŸ“˜ TanÄ±m

Ä°mputasyon, eksik verilerin **istatistiksel veya algoritmik yÃ¶ntemlerle** tahmin edilerek doldurulmasÄ± iÅŸlemidir.

### ğŸ¯ Neden Gerekli?

-   Ã–rneklem boyutunu korur
-   BazÄ± analiz teknikleri eksik veri kabul etmez
-   Bias riskini azaltÄ±r (Ã¶zellikle MCAR/MAR durumlarÄ±nda)

### â— Ne Zaman Risklidir?

-   MNAR durumlarÄ±nda
-   AykÄ±rÄ± deÄŸerler iÃ§eren deÄŸiÅŸkenlerde
-   KÃ¼Ã§Ã¼k veri setlerinde â€œortalama ile doldurmaâ€ genellikle **tehlikelidir**

> ğŸ§  Ä°mputasyon dikkat ister: YanlÄ±ÅŸ teknik = yanlÄ±ÅŸ sonuÃ§

------------------------------------------------------------------------

### ğŸ”§ Basit Ä°mputasyon YÃ¶ntemleri

```{r}
# Ortalama ile
airquality$Ozone <- ifelse(is.na(airquality$Ozone),
                           mean(airquality$Ozone, na.rm = TRUE),
                           airquality$Ozone)

# Ortanca ile
airquality$Solar.R <- ifelse(is.na(airquality$Solar.R),
                             median(airquality$Solar.R, na.rm = TRUE),
                             airquality$Solar.R)
```

âš ï¸ Ortalamayla doldurmak varyansÄ± kÃ¼Ã§Ã¼ltÃ¼r â†’ modelleme etkilenebilir

ğŸ” Basit yÃ¶ntemler hÄ±zlÄ±dÄ±r ama **istatistiksel varsayÄ±mlarÄ± bozabilir**

Bu yÃ¼zden daha sofistike yaklaÅŸÄ±mlar gerekir.

---

### **MICE (Multivariate Imputation by Chained Equations)**

-    DeÄŸiÅŸkenler arasÄ± iliÅŸkiyi koruyarak eksik deÄŸerleri tahmin eder

-   Her eksik deÄŸiÅŸken iÃ§in ayrÄ± regresyon modeli kurar (chain)

-   Ã‡oklu imputasyon yapar: `m` kez tekrar eder â†’ belirsizlik dikkate alÄ±nÄ±r

```{r}
# Gerekli paket
library(mice)

# airquality veri setini gÃ¶zden geÃ§ir
summary(airquality)

# Ã‡oklu imputasyon baÅŸlat
# method = "pmm" predictive mean matching kullanÄ±r
# m = 5 â†’ 5 farklÄ± tamamlanmÄ±ÅŸ veri seti Ã¼retilecek
# seed â†’ tekrar Ã¼retilebilirlik iÃ§in sabitlenir
imp <- mice(airquality, method = "pmm", m = 5, seed = 123)

# Ä°lk tamamlanmÄ±ÅŸ (impute edilmiÅŸ) veri setini al
completed_data <- complete(imp, 1)

# Ozone deÄŸiÅŸkeninin imputasyon Ã¶ncesi ve sonrasÄ± daÄŸÄ±lÄ±mÄ±
summary(airquality$Ozone)
summary(completed_data$Ozone)

```

ğŸ§¾ **AÃ§Ä±klamalar:**

-    `mice()` fonksiyonu eksik verileri deÄŸiÅŸken bazlÄ± modellerle doldurur.

-   `pmm`: Tahmin edilen deÄŸere en yakÄ±n gÃ¶zlemin deÄŸeri kullanÄ±lÄ±r â†’ aykÄ±rÄ± deÄŸer Ã¼retme riski dÃ¼ÅŸer.

-   `complete(imp, 1)`: 5 farklÄ± tamamlanmÄ±ÅŸ veri setinden ilkini alÄ±rÄ±z.

-   Bu iÅŸlemin sonunda elde ettiÄŸimiz `completed_data` modeli kurmaya hazÄ±r hale gelir.

---

### **missForest** (Random Forest ile imputasyon)

-   Hem sayÄ±sal hem kategorik verilerle Ã§alÄ±ÅŸÄ±r

-   Karar aÄŸaÃ§larÄ± kullanarak eksik deÄŸerleri tahmin eder

-   DÄ±ÅŸsal deÄŸiÅŸkenleri etkili biÃ§imde kullanÄ±r

```{r}
# Gerekli paket
library(missForest)

# Random Forest ile imputasyon (dikkat: zaman alabilir!)
# ntree = 100 default, istenirse artÄ±rÄ±labilir
# verbose = TRUE â†’ iÅŸlem ilerleyiÅŸini gÃ¶sterir
set.seed(123)
imp_rf <- missForest(airquality, verbose = TRUE)

# Ä°mpute edilmiÅŸ veri setine eriÅŸim
imputed_data <- imp_rf$ximp

# KarÅŸÄ±laÅŸtÄ±rma: Ozone deÄŸiÅŸkeni
summary(airquality$Ozone)
summary(imputed_data$Ozone)

```

ğŸ§¾ **AÃ§Ä±klamalar:**

-    `missForest()` hem sayÄ±sal hem kategorik deÄŸiÅŸkenlerde Ã§alÄ±ÅŸÄ±r

-   Decision tree yapÄ±larÄ± sayesinde doÄŸrusal olmayan iliÅŸkileri de Ã¶ÄŸrenir

-   `ximp`: Eksik veriler doldurulmuÅŸ hali

-   `OOBerror` gibi hata Ã¶lÃ§Ã¼leri de dÃ¶ner (isteÄŸe baÄŸlÄ± kullanÄ±labilir)

---

### ğŸ” Ã‡oklu Ä°mputasyonun FarkÄ± ve KullanÄ±mÄ±

```{r}
# Her bir tamamlanmÄ±ÅŸ veri seti iÃ§in model kurulumu
fit <- with(imp, lm(Ozone ~ Solar.R + Wind + Temp))

# TÃ¼m modellerin birleÅŸtirilmesi
pooled <- pool(fit)

# HavuzlanmÄ±ÅŸ (pool edilmiÅŸ) regresyon sonuÃ§larÄ±
summary(pooled)
```

ğŸ§¾ **AÃ§Ä±klamalar:**

-    `with()`: Her bir imputasyon setinde regresyon kurar

-   `pool()`: Bu regresyonlarÄ±n sonuÃ§larÄ±nÄ± birleÅŸtirir, varyans ve belirsizliÄŸi yansÄ±tarak gÃ¼venilir sonuÃ§ sunar

-   `summary(pooled)`: Nihai regresyon Ã§Ä±ktÄ±sÄ±nÄ± verir
